version: 2.1
jobs:
  build:
    docker:
      - image: barichello/godot-ci
    steps:
      - checkout
      - run:
          name: Prepare build directory
          command: mkdir -v -p ./build/web
      - run:
          name: Export HTML5 preset
          command: godot -v --export "HTML5" ./build/web/index.html
      - persit_to_workspace:
          root: build
          paths:
            - web
      - store_artifacts:
          path: ./build/web/
      
  deploy-github-pages:
    docker:
      - image: cimg/base:2020.01
    steps:
      - attach_workspace:
          at: build
      - run:
          name: ls
          command: ls -al build/web